{% extends "user_layout.html" %}

{% block title %}Mis Reservas - Hospedaje Sofi{% endblock %}

{% block page_title %}Mis Reservas{% endblock %}

{% block content %}
<section class="reservas-list-section">
    <h2>Reservas Activas</h2>
    {% if reservas_activas and reservas_activas|length > 0 %}
        {% for r in reservas_activas %}
        <div class="reserva-card upcoming">
            <div class="status-badge text-success">{{ r.estado|capitalize }}</div>
            <h3>
                {% if r.habitacion %}
                    {{ r.habitacion.nombre }} - {{ r.habitacion.numero }}
                {% else %}
                    Habitación #{{ r.idhabitacion }}
                {% endif %}
            </h3>
            <p><strong>Fechas:</strong> {{ r.fechainicio.strftime('%d/%m/%Y') }} - {{ r.fechafin.strftime('%d/%m/%Y') }}</p>
            <p><strong>Código:</strong> {{ r.codigoreserva }}</p>
            <div class="card-actions">
                <a class="btn btn-secondary btn-sm" href="/reservas/{{ r.idreserva }}">
                    <i class="fas fa-eye"></i>
                    Ver Detalles
                </a>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">Aún no tienes reservas activas.</p>
    {% endif %}

    <h2>Historial de Reservas</h2>
    {% if reservas_historial and reservas_historial|length > 0 %}
        {% for r in reservas_historial %}
        <div class="reserva-card past-reserva">
            <div class="status-badge text-muted">{{ r.estado|capitalize }}</div>
            <h3>
                {% if r.habitacion %}
                    {{ r.habitacion.nombre }} - {{ r.habitacion.numero }}
                {% else %}
                    Habitación #{{ r.idhabitacion }}
                {% endif %}
            </h3>
            <p><strong>Fechas:</strong> {{ r.fechainicio.strftime('%d/%m/%Y') }} - {{ r.fechafin.strftime('%d/%m/%Y') }}</p>
            <p><strong>Código:</strong> {{ r.codigoreserva }}</p>
            <div class="card-actions">
                <a class="btn btn-secondary btn-sm" href="/reservas/{{ r.idreserva }}">
                    <i class="fas fa-eye"></i>
                    Ver Detalles
                </a>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <p class="text-muted">Aún no hay reservas en tu historial.</p>
    {% endif %}

    <div style="text-align: center; margin-top: 2rem;">
        <a href="/habitaciones" class="btn btn-primary">
            <i class="fas fa-plus"></i>
            Nueva Reserva
        </a>
    </div>
</section>
{% endblock %}