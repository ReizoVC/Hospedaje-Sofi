{% extends "staff_layout.html" %}

{% block title %}Hospedaje Sofi | Gestión{% endblock %}

{% block content %}
<section class="gestion-container">
    <div class="container">
        <h1 class="titulo-seccion">Panel de Gestión</h1>
        
        <!-- Navegación de pestañas -->
        <div class="tabs-nav">
            <button class="tab-btn active" data-tab="habitaciones">Habitaciones</button>
            <button class="tab-btn" data-tab="reservas">Reservas</button>
            <button class="tab-btn" data-tab="personal">Personal</button>
            <button class="tab-btn" data-tab="desactivados">Desactivados</button>
        </div>

        <!-- Contenido de pestañas -->
        <div class="tab-content active" id="habitaciones">
            <div class="crud-header">
                <h2>Gestión de Habitaciones</h2>
                <button class="btn-primary" id="btn-nueva-habitacion">
                    <i class="fas fa-plus"></i> Nueva Habitación
                </button>
            </div>

            <!-- Tabla de habitaciones -->
            <div class="table-container">
                <table class="crud-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Número</th>
                            <th>Nombre</th>
                            <th>Estado</th>
                            <th>Capacidad</th>
                            <th>Precio/Noche</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="habitaciones-tbody">
                        <!-- Las habitaciones se cargarán dinámicamente -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="tab-content" id="reservas">
            <div class="crud-header">
                <h2>Gestión de Reservas</h2>
                <button class="btn-primary" id="btn-nueva-reserva">
                    <i class="fas fa-plus"></i> Nueva Reserva
                </button>
            </div>

            <div class="table-container">
                <table class="crud-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Código</th>
                            <th>Usuario</th>
                            <th>Habitación</th>
                            <th>Ingreso</th>
                            <th>Salida</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="reservas-tbody"></tbody>
                </table>
            </div>
        </div>

        <div class="tab-content" id="personal">
            <div class="crud-header">
                <h2>Gestión de Personal</h2>
                <button class="btn-primary" id="btn-nuevo-personal">
                    <i class="fas fa-user-plus"></i> Nuevo Personal
                </button>
            </div>
            <div class="table-container">
                <table class="crud-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Apellidos</th>
                            <th>Correo</th>
                            <th>DNI</th>
                            <th>Teléfono</th>
                            <th>Rol</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="personal-tbody"></tbody>
                </table>
            </div>
        </div>

        <div class="tab-content" id="desactivados">
            <div class="crud-header">
                <h2>Personal Desactivado</h2>
                <button class="btn-secondary" id="btn-refrescar-desactivados">
                    <i class="fas fa-rotate"></i> Recargar
                </button>
            </div>
            <div class="table-container">
                <table class="crud-table">
                    <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>Apellidos</th>
                            <th>Correo</th>
                            <th>DNI</th>
                            <th>Teléfono</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="desactivados-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>
</section>

<!-- Modal para crear/editar habitación -->
<div class="modal" id="modal-habitacion">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-titulo">Nueva Habitación</h3>
            <button class="modal-close" id="btn-cerrar-modal">&times;</button>
        </div>
        <form id="form-habitacion">
            <div class="form-grid">
                <div class="form-group">
                    <label for="numero">Número de Habitación</label>
                    <input type="number" id="numero" name="numero" required>
                </div>
                
                <div class="form-group">
                    <label for="nombre">Nombre</label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>
                
                <div class="form-group">
                    <label for="estado">Estado</label>
                    <select id="estado" name="estado" required>
                        <option value="disponible">Disponible</option>
                        <option value="ocupada">Ocupada</option>
                        <option value="mantenimiento">Mantenimiento</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="capacidad">Capacidad</label>
                    <input type="number" id="capacidad" name="capacidad" min="1" required>
                </div>
                
                <div class="form-group">
                    <label for="precio_noche">Precio por Noche (S/)</label>
                    <input type="number" id="precio_noche" name="precio_noche" step="0.01" min="0" required>
                </div>
                
                <div class="form-group">
                    <label for="tamano_m2">Tamaño (m²)</label>
                    <input type="number" id="tamano_m2" name="tamano_m2" min="1">
                </div>
                
                <div class="form-group full-width">
                    <label for="camas">Tipo de Camas</label>
                    <input type="text" id="camas" name="camas" placeholder="Ej: 1 cama king, 2 camas individuales">
                </div>
                
                <div class="form-group full-width">
                    <label for="descripcion">Descripción</label>
                    <textarea id="descripcion" name="descripcion" rows="3"></textarea>
                </div>
                
                <div class="form-group full-width">
                    <label for="servicios">Servicios (separados por coma)</label>
                    <input type="text" id="servicios" name="servicios" placeholder="WiFi, Aire acondicionado, TV, Minibar">
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-cancelar">Cancelar</button>
                <button type="submit" class="btn-primary" id="btn-guardar">Guardar</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal para gestionar imágenes -->
<div class="modal" id="modal-imagenes">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-imagenes-titulo">Gestionar Imágenes</h3>
            <button class="modal-close" id="btn-cerrar-modal-imagenes">&times;</button>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="upload-imagenes">Subir Imágenes</label>
                <input type="file" id="upload-imagenes" accept="image/*" multiple>
                <button type="button" class="btn-primary" onclick="subirImagenes()">
                    <i class="fas fa-upload"></i> Subir
                </button>
            </div>
            
            <div id="imagenes-list" class="imagenes-container">
                <!-- Las imágenes se cargarán dinámicamente -->
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn-secondary" id="btn-cerrar-imagenes">Cerrar</button>
        </div>
    </div>
</div>

<!-- Modal para crear/editar reserva -->
<div class="modal" id="modal-reserva">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-reserva-titulo">Nueva Reserva</h3>
            <button class="modal-close" id="btn-cerrar-modal-reserva">&times;</button>
        </div>
        <form id="form-reserva">
            <div class="form-grid">
                <div class="form-group">
                    <label for="res-usuario">Usuario</label>
                    <select id="res-usuario" name="idusuario" required></select>
                </div>
                <div class="form-group">
                    <label for="res-habitacion">Habitación</label>
                    <select id="res-habitacion" name="idhabitacion" required></select>
                </div>
                <div class="form-group">
                    <label for="res-fechainicio">Fecha ingreso</label>
                    <input type="date" id="res-fechainicio" name="fechainicio" required>
                </div>
                <div class="form-group">
                    <label for="res-fechafin">Fecha salida</label>
                    <input type="date" id="res-fechafin" name="fechafin" required>
                </div>
                <div class="form-group">
                    <label for="res-estado">Estado</label>
                    <select id="res-estado" name="estado">
                        <option value="pendiente">pendiente</option>
                        <option value="confirmada">confirmada</option>
                        <option value="activa">activa</option>
                        <option value="completada">completada</option>
                        <option value="cancelada">cancelada</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-cancelar-reserva">Cancelar</button>
                <button type="submit" class="btn-primary">Guardar</button>
            </div>
        </form>
    </div>
    </div>

<!-- Modal para crear/editar personal -->
<div class="modal" id="modal-personal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modal-personal-titulo">Nuevo Personal</h3>
            <button class="modal-close" id="btn-cerrar-modal-personal">&times;</button>
        </div>
        <form id="form-personal">
            <div class="form-grid">
                <div class="form-group">
                    <label for="per-nombre">Nombre</label>
                    <input type="text" id="per-nombre" name="nombre" required>
                </div>
                <div class="form-group">
                    <label for="per-apellidos">Apellidos</label>
                    <input type="text" id="per-apellidos" name="apellidos" required>
                </div>
                <div class="form-group">
                    <label for="per-correo">Correo</label>
                    <input type="email" id="per-correo" name="correo" required>
                </div>
                <div class="form-group">
                    <label for="per-dni">DNI</label>
                    <input type="text" id="per-dni" name="dni" required>
                </div>
                <div class="form-group">
                    <label for="per-telefono">Teléfono</label>
                    <input type="text" id="per-telefono" name="telefono">
                </div>
                <div class="form-group">
                    <label for="per-rol">Rol</label>
                    <select id="per-rol" name="rol" required>
                        <option value="2">Recepcionista</option>
                        <option value="3">Almacenista</option>
                        <!-- Los administradores no se mostrarán en las listas -->
                    </select>
                </div>
                <div class="form-group full-width">
                    <label for="per-clave">Clave <small>(dejar en blanco para no cambiar)</small></label>
                    <input type="password" id="per-clave" name="clave" placeholder="••••••">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="btn-cancelar-personal">Cancelar</button>
                <button type="submit" class="btn-primary" id="btn-guardar-personal">Guardar</button>
            </div>
        </form>
    </div>
</div>

<script src="{{ url_for('static', filename='js/gestion.js') }}"></script>
{% endblock %}